rules:
- name: "node-ports"
  description: "Allow external traffic to NodePorts"
  action: "allow"
  direction: "inbound"
  port_range: "3000-32767"
  from: "*"
  to: "cluster"
  protocol: "tcp"
- name: "apiserver"
  description: "Allow servers in the VPC to access the apiserver on controlplane nodes"
  action: "allow"
  direction: "inbound"
  port_range: "6443"
  from: "vpc"
  to: "controlplane"
  protocol: "tcp"
- name: "kubelet-health-checks"
  description: "Allow controlplane nodes to execute kubelet health checks"
  action: "allow"
  direction: "inbound"
  port_range: "10250"
  from: "controlplane"
  to: "worker"
  protocol: "tcp"
- name: "etcd-health-checks"
  description: "Allow controlplane nodes to execute etcd health checks to port 2379"
  action: "allow"
  direction: "inbound"
  port_range: "2379-2380"
  from: "controlplane"
  to: "etcd"
  protocol: "tcp"
- name: "etcd-peering"
  description: "Allow etcd nodes to communicate with other etcd nodes on etcd ports"
  action: "allow"
  direction: "inbound"
  port_range: "2379-2380"
  from: "etcd"
  to: "etcd"
  protocol: "tcp"